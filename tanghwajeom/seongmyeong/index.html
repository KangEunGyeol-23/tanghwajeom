<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>성명학 분석 도구</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .header {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            color: white;
            text-align: center;
            padding: 40px 20px;
        }
        
        .title {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            letter-spacing: 1px;
        }
        
        .input-section {
            padding: 40px;
            background: white;
            transition: all 0.5s ease;
        }
        
        .input-section.hidden {
            display: none;
        }
        
        .input-group {
            margin-bottom: 30px;
        }
        
        .input-group label {
            display: block;
            font-size: 1.1em;
            color: #444;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .input-group input {
            width: 100%;
            padding: 15px 20px;
            font-size: 1.1em;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            color: #333;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #007bff;
            background: white;
            box-shadow: 0 0 20px rgba(0, 123, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .analyze-btn {
            width: 100%;
            padding: 18px;
            font-size: 1.2em;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        .analyze-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }
        
        .result {
            background: white;
            padding: 40px;
        }
        
        .result-title {
            text-align: center;
            font-size: 2em;
            color: #333;
            font-weight: 700;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .ganzi-info {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #ffecd2, #fcb69f);
            border-radius: 15px;
            color: #8b4513;
            font-weight: 600;
        }
        
        .char-analysis {
            margin-bottom: 30px;
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e9ecef;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .char-table {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            background: white;
        }
        
        .char-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .ganzi-header {
            background: #6db4e8;
            color: white;
            height: 50px;
            font-size: 1.3em;
        }
        
        .derived-row {
            background: #e8eaf0;
            height: 40px;
        }
        
        .derived-cell {
            color: #d32f2f;
        }
        
        .sipseong-row {
            background: white;
            height: 50px;
        }
        
        .sipseong-number {
            color: #d32f2f;
            font-size: 1.2em;
        }
        
        .char-cell {
            font-size: 2.5em;
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .cheongan-row {
            background: #f0f0f0;
            height: 40px;
        }
        
        .buttons {
            text-align: center;
            margin-top: 30px;
        }
        
        .derived-toggle {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            margin-right: 15px;
            transition: all 0.3s ease;
        }
        
        .derived-toggle:hover {
            transform: translateY(-2px);
        }
        
        .derived-toggle.active {
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        
        .new-analysis-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .new-analysis-btn:hover {
            transform: translateY(-2px);
        }
        
        .derived-highlight {
            background: #ffd700 !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">🔮 성명학 분석</h1>
            <p class="subtitle">이름과 생년월일로 운명을 읽다</p>
        </div>
        
        <div class="input-section" id="inputSection">
            <div class="input-group">
                <label for="nameInput">이름</label>
                <input type="text" id="nameInput" placeholder="이름을 입력하세요 (예: 강민희)" maxlength="5">
            </div>
            
            <div class="input-group">
                <label for="yearInput">태어난 년도</label>
                <input type="number" id="yearInput" placeholder="년도를 입력하세요 (예: 1979)" min="1900" max="2025">
            </div>
            
            <button class="analyze-btn" onclick="analyzeName()">🌟 성명학 분석하기</button>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        // 자음 획수
        const consonantStrokes = {
            'ㄱ': 1, 'ㄴ': 1, 'ㄷ': 2, 'ㄹ': 3, 'ㅁ': 3, 'ㅂ': 4, 'ㅅ': 2,
            'ㅇ': 1, 'ㅈ': 3, 'ㅊ': 4, 'ㅋ': 2, 'ㅌ': 3, 'ㅍ': 4, 'ㅎ': 3,
            'ㄲ': 2, 'ㄸ': 4, 'ㅃ': 8, 'ㅆ': 4, 'ㅉ': 6
        };
        
        // 모음 획수
        const vowelStrokes = {
            'ㅏ': 2, 'ㅑ': 3, 'ㅓ': 2, 'ㅕ': 3, 'ㅗ': 2, 'ㅛ': 3, 
            'ㅜ': 2, 'ㅠ': 3, 'ㅡ': 1, 'ㅣ': 1, 'ㅐ': 3, 'ㅒ': 4, 
            'ㅔ': 3, 'ㅖ': 4, 'ㅘ': 4, 'ㅙ': 5, 'ㅚ': 4, 'ㅝ': 4, 
            'ㅞ': 5, 'ㅟ': 4, 'ㅢ': 2
        };
        
        // 자음 → 오행 분류
        const consonantToElement = {
            'ㄱ': '木', 'ㅋ': '木',
            'ㄴ': '火', 'ㄷ': '火', 'ㄹ': '火', 'ㅌ': '火',
            'ㅇ': '土', 'ㅎ': '土',
            'ㅅ': '金', 'ㅈ': '金', 'ㅊ': '金',
            'ㅁ': '水', 'ㅂ': '水', 'ㅍ': '水',
            'ㄲ': '木', 'ㄸ': '火', 'ㅃ': '水', 'ㅆ': '金', 'ㅉ': '金'
        };
        
        // 오행별 천간
        const elementToCheongan = {
            '木': ['甲', '乙'], '火': ['丙', '丁'], '土': ['戊', '己'],
            '金': ['庚', '辛'], '水': ['壬', '癸']
        };
        
        // 지지 음양
        const jiYinYang = {
            '子': '-', '丑': '-', '寅': '+', '卯': '-', '辰': '+', '巳': '+',
            '午': '-', '未': '-', '申': '+', '酉': '-', '戌': '+', '亥': '+'
        };
        
        // 십성 이름
        const sipseongNames = [
            '정인', '비견', '겁재', '식신', '상관', '편재', '정재', '편관', '정관', '편인'
        ];
        
        // 한글 분해
        function hangulDecompose(char) {
            const charCode = char.charCodeAt(0);
            if (charCode < 0xAC00 || charCode > 0xD7A3) return null;
            
            const index = charCode - 0xAC00;
            const initial = Math.floor(index / 588);
            const medial = Math.floor((index % 588) / 28);
            const final = index % 28;
            
            const initials = ['ㄱ','ㄲ','ㄴ','ㄷ','ㄸ','ㄹ','ㅁ','ㅂ','ㅃ','ㅅ','ㅆ','ㅇ','ㅈ','ㅉ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
            const medials = ['ㅏ','ㅐ','ㅑ','ㅒ','ㅓ','ㅔ','ㅕ','ㅖ','ㅗ','ㅘ','ㅙ','ㅚ','ㅛ','ㅜ','ㅝ','ㅞ','ㅟ','ㅠ','ㅡ','ㅢ','ㅣ'];
            const finals = ['','ㄱ','ㄲ','ㄱㅅ','ㄴ','ㄴㅈ','ㄴㅎ','ㄷ','ㄹ','ㄹㄱ','ㄹㅁ','ㄹㅂ','ㄹㅅ','ㄹㅌ','ㄹㅍ','ㄹㅎ','ㅁ','ㅂ','ㅂㅅ','ㅅ','ㅆ','ㅇ','ㅈ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
            
            return {
                initial: initials[initial],
                medial: medials[medial],
                final: final === 0 ? '' : finals[final]
            };
        }
        
        // 간지 계산
        function getGanJi(year) {
            const gan = ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'];
            const ji = ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'];
            const ganHanja = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
            const jiHanja = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
            
            const baseYear = 1984;
            const yearDiff = year - baseYear;
            
            let ganIndex = yearDiff % 10;
            let jiIndex = yearDiff % 12;
            
            if (ganIndex < 0) ganIndex += 10;
            if (jiIndex < 0) jiIndex += 12;
            
            return {
                ganHanja: ganHanja[ganIndex],
                jiHanja: jiHanja[jiIndex],
                fullKorean: gan[ganIndex] + ji[jiIndex] + '년'
            };
        }
        
        // 십성 계산
        function calculateSipseong(myElement, targetElement) {
            if (!myElement || !targetElement || myElement.length < 2 || targetElement.length < 2) {
                return 0;
            }
            
            const relations = {
                '木': { generates: '火', destroys: '土', generatedBy: '水', destroyedBy: '金' },
                '火': { generates: '土', destroys: '金', generatedBy: '木', destroyedBy: '水' },
                '土': { generates: '金', destroys: '水', generatedBy: '火', destroyedBy: '木' },
                '金': { generates: '水', destroys: '木', generatedBy: '土', destroyedBy: '火' },
                '水': { generates: '木', destroys: '火', generatedBy: '金', destroyedBy: '土' }
            };
            
            const myElementType = myElement.charAt(0);
            const myYinYang = myElement.charAt(1);
            const targetElementType = targetElement.charAt(0);
            const targetYinYang = targetElement.charAt(1);
            
            if (!relations[myElementType] || !relations[targetElementType]) {
                return 0;
            }
            
            const sameYinYang = myYinYang === targetYinYang;
            
            if (myElementType === targetElementType) {
                return sameYinYang ? 1 : 2; // 비견 : 겁재
            } else if (relations[myElementType].generates === targetElementType) {
                return sameYinYang ? 3 : 4; // 식신 : 상관
            } else if (relations[myElementType].destroys === targetElementType) {
                return sameYinYang ? 5 : 6; // 편재 : 정재
            } else if (relations[myElementType].destroyedBy === targetElementType) {
                return sameYinYang ? 7 : 8; // 편관 : 정관
            } else if (relations[myElementType].generatedBy === targetElementType) {
                return sameYinYang ? 9 : 0; // 편인 : 정인
            }
            
            return 0;
        }
        
        function getElementFromHanja(hanja) {
            const hanjaToElement = {
                '甲': '木', '乙': '木', '丙': '火', '丁': '火', 
                '戊': '土', '己': '土', '庚': '金', '辛': '金',
                '壬': '水', '癸': '水',
                '子': '水', '丑': '土', '寅': '木', '卯': '木', 
                '辰': '土', '巳': '火', '午': '火', '未': '土',
                '申': '金', '酉': '金', '戌': '土', '亥': '水'
            };
            return hanjaToElement[hanja] || '土';
        }
        
        function getCheonganHanja(element, isPositive) {
            const cheongans = elementToCheongan[element];
            return isPositive ? cheongans[0] : cheongans[1];
        }
        
        function analyzeName() {
            const name = document.getElementById('nameInput').value.trim();
            const year = parseInt(document.getElementById('yearInput').value);
            
            if (!name || !year) {
                alert('이름과 태어난 년도를 모두 입력해주세요.');
                return;
            }
            
            document.getElementById('inputSection').classList.add('hidden');
            
            const ganJi = getGanJi(year);
            const ganElement = getElementFromHanja(ganJi.ganHanja);
            const jiElement = getElementFromHanja(ganJi.jiHanja);
            const ganYinYang = ['甲','丙','戊','庚','壬'].includes(ganJi.ganHanja) ? '+' : '-';
            const jiYinYangValue = jiYinYang[ganJi.jiHanja] || '+';
            
            let resultHTML = `
                <div class="result">
                    <div class="result-title">🔮 ${name}님의 성명학 분석 결과</div>
                    <div class="ganzi-info">
                        <strong>태어난 해:</strong> ${year}년 ${ganJi.fullKorean} (${ganJi.ganHanja}${ganJi.jiHanja})
                    </div>
            `;
            
            // 각 글자 분석
            for (let i = 0; i < name.length; i++) {
                const char = name[i];
                const decomposed = hangulDecompose(char);
                
                if (!decomposed) continue;
                
                const {initial, medial, final} = decomposed;
                
                // 총 획수 계산
                let totalStrokes = 0;
                totalStrokes += consonantStrokes[initial] || 0;
                totalStrokes += vowelStrokes[medial] || 0;
                if (final) totalStrokes += consonantStrokes[final] || 0;
                
                // 음양 결정
                const isPositive = totalStrokes % 2 === 1;
                const yinYangSymbol = isPositive ? '+' : '-';
                
                // 자음들 추출
                const consonants = [initial];
                if (final && final !== '') {
                    consonants.push(final);
                }
                
                // 천간 변환
                const cheonganList = [];
                consonants.forEach(consonant => {
                    const element = consonantToElement[consonant];
                    if (element) {
                        const cheonganHanja = getCheonganHanja(element, isPositive);
                        cheonganList.push(cheonganHanja);
                    }
                });
                
                // 표 생성
                let tableHTML = `
                    <div class="char-analysis">
                        <table class="char-table" data-char="${char}">
                            <tr>
                                <td colspan="7" class="ganzi-header">${ganJi.ganHanja} ${ganJi.jiHanja}</td>
                            </tr>
                            <tr class="derived-row">
                                <td class="derived-cell derived-left-p">P</td>
                                <td class="derived-cell derived-left-num"></td>
                                <td class="derived-cell"></td>
                                <td class="derived-cell"></td>
                                <td class="derived-cell"></td>
                                <td class="derived-cell derived-right-num"></td>
                                <td class="derived-cell derived-right-p">P</td>
                            </tr>
                `;
                
                // 각 천간별 십성 계산 및 행 추가
                cheonganList.forEach((cheongan, index) => {
                    const myElement = getElementFromHanja(cheongan);
                    
                    // 간지의 천간과 지지에 대해 각각 십성 계산
                    const ganSip = calculateSipseong(
                        myElement + yinYangSymbol, 
                        ganElement + ganYinYang
                    );
                    const jiSip = calculateSipseong(
                        myElement + yinYangSymbol,
                        jiElement + jiYinYangValue
                    );
                    
                    console.log(`${char}자 ${cheongan}:`, {
                        cheongan: cheongan,
                        myElement: myElement + yinYangSymbol,
                        vs_gan: ganElement + ganYinYang,
                        vs_ji: jiElement + jiYinYangValue,
                        ganSip: ganSip,
                        jiSip: jiSip
                    });
                    
                    if (index === 0) {
                        tableHTML += `
                            <tr class="sipseong-row" data-left-sipseong="${ganSip}" data-right-sipseong="${jiSip}">
                                <td class="derived-left-cell"></td>
                                <td class="sipseong-number">${ganSip}</td>
                                <td>${sipseongNames[ganSip]}</td>
                                ${cheonganList.length === 1 ? 
                                    `<td class="char-cell">${char}</td>` : 
                                    `<td rowspan="${cheonganList.length}" class="char-cell">${char}</td>`
                                }
                                <td>${sipseongNames[jiSip]}</td>
                                <td class="sipseong-number">${jiSip}</td>
                                <td class="derived-right-cell"></td>
                            </tr>
                        `;
                    } else {
                        tableHTML += `
                            <tr class="sipseong-row">
                                <td class="derived-left-cell"></td>
                                <td class="sipseong-number">${ganSip}</td>
                                <td>${sipseongNames[ganSip]}</td>
                                <td>${sipseongNames[jiSip]}</td>
                                <td class="sipseong-number">${jiSip}</td>
                                <td class="derived-right-cell"></td>
                            </tr>
                        `;
                    }
                });
                
                // 천간 행
                tableHTML += `
                    <tr class="cheongan-row">
                        <td colspan="7">${cheonganList.join(' ')}</td>
                    </tr>
                </table>
                </div>
                `;
                
                resultHTML += tableHTML;
            }
            
            // 버튼들
            resultHTML += `
                <div class="buttons">
                    <button class="derived-toggle" onclick="toggleDerived()">🔢 파생수 보기/숨기기</button>
                    <button class="new-analysis-btn" onclick="newAnalysis()">🔄 새로운 분석하기</button>
                </div>
                </div>
            `;
            
            document.getElementById('result').innerHTML = resultHTML;
        }
        
        // 파생수 계산
        function calculateDerivedNumber(first, second) {
            const derivedMap = {
                // 1,2 ↔ 5,6 = 9,0 파생 (크로스)
                '1-5': '9,0', '1-6': '9,0', '2-5': '9,0', '2-6': '9,0',
                '5-1': '9,0', '5-2': '9,0', '6-1': '9,0', '6-2': '9,0',
                
                // 5,6 ↔ 9,0 = 3,4 파생 (크로스)
                '5-9': '3,4', '5-0': '3,4', '6-9': '3,4', '6-0': '3,4',
                '9-5': '3,4', '9-6': '3,4', '0-5': '3,4', '0-6': '3,4',
                
                // 9,0 ↔ 3,4 = 1,2 파생 (크로스)
                '9-3': '1,2', '9-4': '1,2', '0-3': '1,2', '0-4': '1,2',
                '3-9': '1,2', '3-0': '1,2', '4-9': '1,2', '4-0': '1,2',
                
                // 3,4 ↔ 7,8 = 1,2 파생 (크로스)
                '3-7': '1,2', '3-8': '1,2', '4-7': '1,2', '4-8': '1,2',
                '7-3': '1,2', '7-4': '1,2', '8-3': '1,2', '8-4': '1,2',
                
                // 7,8 ↔ 1,2 = 5,6 파생 (크로스)
                '7-1': '5,6', '7-2': '5,6', '8-1': '5,6', '8-2': '5,6',
                '1-7': '5,6', '1-8': '5,6', '2-7': '5,6', '2-8': '5,6'
            };
            
            const key = first + '-' + second;
            const result = derivedMap[key] || null;
            console.log('파생수 매핑:', key, '→', result);
            return result;
        }
        
        function toggleDerived() {
            const button = document.querySelector('.derived-toggle');
            const isActive = button.classList.contains('active');
            
            if (!isActive) {
                // 파생수 보이기
                const tables = document.querySelectorAll('[data-char]');
                const charData = [];
                
                tables.forEach((table, index) => {
                    const firstDataRow = table.querySelector('[data-left-sipseong]');
                    if (firstDataRow) {
                        const leftSipseong = parseInt(firstDataRow.getAttribute('data-left-sipseong'));
                        const rightSipseong = parseInt(firstDataRow.getAttribute('data-right-sipseong'));
                        charData.push({
                            index: index,
                            leftSipseong: leftSipseong,
                            rightSipseong: rightSipseong,
                            table: table
                        });
                    }
                });
                
                // 1. 각 글자 내부 세로 극 관계 파생수 계산
                charData.forEach(char => {
                    const internalDerived = calculateDerivedNumber(char.leftSipseong, char.rightSipseong);
                    console.log(`글자 내부 세로 극 관계: ${char.leftSipseong}↔${char.rightSipseong} → ${internalDerived}`);
                    
                    if (internalDerived) {
                        // 해당 글자의 모든 행 양쪽에 파생수 표시
                        const leftCells = char.table.querySelectorAll('.derived-left-cell');
                        const rightCells = char.table.querySelectorAll('.derived-right-cell');
                        
                        leftCells.forEach(cell => {
                            cell.textContent = internalDerived;
                            cell.classList.add('derived-highlight');
                        });
                        
                        rightCells.forEach(cell => {
                            cell.textContent = internalDerived;
                            cell.classList.add('derived-highlight');
                        });
                    }
                });
                
                // 2. 글자 간 극 관계 파생수 계산
                for (let i = 0; i < charData.length - 1; i++) {
                    const current = charData[i];
                    const next = charData[i + 1];
                    
                    // 왼쪽끼리 극 관계 확인
                    const leftDerived = calculateDerivedNumber(current.leftSipseong, next.leftSipseong);
                    console.log(`왼쪽 극 관계: ${current.leftSipseong}↔${next.leftSipseong} → ${leftDerived}`);
                    
                    // 오른쪽끼리 극 관계 확인  
                    const rightDerived = calculateDerivedNumber(current.rightSipseong, next.rightSipseong);
                    console.log(`오른쪽 극 관계: ${current.rightSipseong}↔${next.rightSipseong} → ${rightDerived}`);
                    
                    if (leftDerived) {
                        // 현재 글자 왼쪽에 파생수 표시 (내부 파생수가 없는 경우만)
                        const currentLeftCells = current.table.querySelectorAll('.derived-left-cell');
                        currentLeftCells.forEach(cell => {
                            if (!cell.textContent) {
                                cell.textContent = leftDerived;
                                cell.classList.add('derived-highlight');
                            }
                        });
                        
                        // 다음 글자 왼쪽에 파생수 표시 (내부 파생수가 없는 경우만)
                        const nextLeftCells = next.table.querySelectorAll('.derived-left-cell');
                        nextLeftCells.forEach(cell => {
                            if (!cell.textContent) {
                                cell.textContent = leftDerived;
                                cell.classList.add('derived-highlight');
                            }
                        });
                    }
                    
                    if (rightDerived) {
                        // 현재 글자 오른쪽에 파생수 표시 (내부 파생수가 없는 경우만)
                        const currentRightCells = current.table.querySelectorAll('.derived-right-cell');
                        currentRightCells.forEach(cell => {
                            if (!cell.textContent) {
                                cell.textContent = rightDerived;
                                cell.classList.add('derived-highlight');
                            }
                        });
                        
                        // 다음 글자 오른쪽에 파생수 표시 (내부 파생수가 없는 경우만)
                        const nextRightCells = next.table.querySelectorAll('.derived-right-cell');
                        nextRightCells.forEach(cell => {
                            if (!cell.textContent) {
                                cell.textContent = rightDerived;
                                cell.classList.add('derived-highlight');
                            }
                        });
                    }
                }
                
                button.textContent = '📁 파생수 숨기기';
                button.classList.add('active');
            } else {
                // 파생수 숨기기
                const derivedCells = document.querySelectorAll('.derived-highlight');
                derivedCells.forEach(cell => {
                    cell.textContent = '';
                    cell.classList.remove('derived-highlight');
                });
                
                button.textContent = '🔢 파생수 보기/숨기기';
                button.classList.remove('active');
            }
        }
        
        function newAnalysis() {
            document.getElementById('inputSection').classList.remove('hidden');
            document.getElementById('result').innerHTML = '';
            document.getElementById('nameInput').value = '';
            document.getElementById('yearInput').value = '';
            document.getElementById('nameInput').focus();
        }
        
        // Enter key support
        document.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.getElementById('nameInput');
            const yearInput = document.getElementById('yearInput');
            
            if (nameInput) {
                nameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        yearInput.focus();
                    }
                });
            }
            
            if (yearInput) {
                yearInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        analyzeName();
                    }
                });
            }
        });
    </script>
</body>
</html>
